package models

import "time"

// Vulnerability represents a CVE or GHSA with metadata
type Vulnerability struct {
	ID          string    `json:"id" yaml:"id"`     // CVE-YYYY-XXXX or GHSA-xxxx-xxxx-xxxx
	Type        string    `json:"type" yaml:"type"` // "cve" or "ghsa"
	Title       string    `json:"title,omitempty" yaml:"title,omitempty"`
	Description string    `json:"description,omitempty" yaml:"description,omitempty"`
	Severity    string    `json:"severity,omitempty" yaml:"severity,omitempty"` // CRITICAL, HIGH, MEDIUM, LOW
	CVSSScore   float64   `json:"cvss_score,omitempty" yaml:"cvss_score,omitempty"`
	Published   time.Time `json:"published,omitempty" yaml:"published,omitempty"`
	Modified    time.Time `json:"modified,omitempty" yaml:"modified,omitempty"`

	// LLM-enriched data
	AffectedVersions     []string   `json:"affected_versions,omitempty" yaml:"affected_versions,omitempty"`
	AttackVectors        []string   `json:"attack_vectors,omitempty" yaml:"attack_vectors,omitempty"`
	ExploitPrerequisites []string   `json:"exploit_prerequisites,omitempty" yaml:"exploit_prerequisites,omitempty"`
	EnrichedAt           *time.Time `json:"enriched_at,omitempty" yaml:"enriched_at,omitempty"`
}
